
<!DOCTYPE html>



<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Priority Queues with Binary Heaps &mdash; Python Courseware</title>
    
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/video.css" type="text/css" />
    <link rel="stylesheet" href="../_static/codelens/v3/css/pytutor.css" type="text/css" />
    <link rel="stylesheet" href="../_static/codelens/v3/css/basic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/codelens/v3/css/ui-lightness/jquery-ui-1.8.24.custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/codemirror.css" type="text/css" />
    <link rel="stylesheet" href="../_static/theme/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/activecode.css" type="text/css" />
    <link rel="stylesheet" href="../_static/js-parsons/parsons.css" type="text/css" />
    <link rel="stylesheet" href="../_static/js-parsons/lib/prettify.css" type="text/css" />
    <link rel="stylesheet" href="../_static/user-highlights.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/codelens/v3/js/jquery.simplemodal.js"></script>
    <script type="text/javascript" src="../_static/codelens/v3/js/d3.v2.min.js"></script>
    <script type="text/javascript" src="../_static/codelens/v3/js/jquery.ba-bbq.min.js"></script>
    <script type="text/javascript" src="../_static/codelens/v3/js/jquery.jsPlumb-1.3.10-all-min.js"></script>
    <script type="text/javascript" src="../_static/codelens/v3/js/jquery-ui-1.8.24.custom.min.js"></script>
    <script type="text/javascript" src="../_static/codelens/v3/js/pytutor.js"></script>
    <script type="text/javascript" src="../_static/jquery.highlight.js"></script>
    <script type="text/javascript" src="../_static/bookfuncs.js"></script>
    <script type="text/javascript" src="../_static/codemirror.js"></script>
    <script type="text/javascript" src="../_static/python.js"></script>
    <script type="text/javascript" src="../_static/activecode.js"></script>
    <script type="text/javascript" src="../_static/skulpt/dist/skulpt.js"></script>
    <script type="text/javascript" src="../_static/skulpt/dist/builtin.js"></script>
    <script type="text/javascript" src="../_static/assess.js"></script>
    <script type="text/javascript" src="../_static/animationbase.js"></script>
    <script type="text/javascript" src="../_static/js-parsons/lib/jquery.min.js"></script>
    <script type="text/javascript" src="../_static/js-parsons/lib/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../_static/js-parsons/lib/prettify.js"></script>
    <script type="text/javascript" src="../_static/js-parsons/lib/underscore-min.js"></script>
    <script type="text/javascript" src="../_static/js-parsons/lib/lis.js"></script>
    <script type="text/javascript" src="../_static/js-parsons/parsons.js"></script>
    <script type="text/javascript" src="../_static/parsons-noconflict.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/rangy-core.js"></script>
    <script type="text/javascript" src="../_static/rangy-textrange.js"></script>
    <script type="text/javascript" src="../_static/rangy-cssclassapplier.js"></script>
    <script type="text/javascript" src="../_static/user-highlights.js"></script>
    <link rel="top" title="Python Courseware" href="../index.html" />
    <link rel="next" title="Binary Search Trees" href="bst.html" />
    <link rel="prev" title="Binary Tree Applications" href="bintreeapps.html" />
<script type="text/javascript">
eBookConfig = {}
eBookConfig.host = 'http://127.0.0.1:8000' ? 'http://127.0.0.1:8000' : 'http://127.0.0.1:8000',
eBookConfig.app = eBookConfig.host+'/runestone',
eBookConfig.ajaxURL = eBookConfig.app+'/ajax/',
eBookConfig.course = 'pd',
eBookConfig.logLevel = 10,
eBookConfig.loginRequired = true
eBookConfig.isLoggedIn = false;
</script>
<script type="text/javascript" charset="utf-8" src="http://127.0.0.1:8000/runestone/static/js/jquery.idle-timer.js">
</script>
<script type="text/javascript" src="http://127.0.0.1:8000/runestone/static/js/processing-1.4.1.min.js"></script>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>


  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="bst.html" title="Binary Search Trees"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="bintreeapps.html" title="Binary Tree Applications"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Python Courseware</a> &raquo;</li>
<li class="right"><span class="loginout"><a href="/runestone/default/user/logout">logout</a></span>| </li>

      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <p class="logo"><a href="../index.html">
    <img class="logo" src="../_static/logo.jpg" alt="Logo" title="Click for Main Table of Contents"/>
  </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Priority Queues with Binary Heaps</a><ul>
<li><a class="reference internal" href="#binary-heap-operations">Binary Heap Operations</a></li>
<li><a class="reference internal" href="#binary-heap-implementation">Binary Heap Implementation</a><ul>
<li><a class="reference internal" href="#the-structure-property">The Structure Property</a></li>
<li><a class="reference internal" href="#the-heap-order-property">The Heap Order Property</a></li>
<li><a class="reference internal" href="#heap-operations">Heap Operations</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="bintreeapps.html"
                        title="previous chapter">Binary Tree Applications</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="bst.html"
                        title="next chapter">Binary Search Trees</a></p><div id="runestonebox">
  <h3>Runestone Links</h3>
  <ul>
    <li> <span id="numuserspan"></span> Readers Online Now </li>
    <li>
      <a href="/runestone/static/pd/navhelp.html">Navigation Help</a>
    </li>
    <li>
      <a href="https://github.com/bnmnetp/runestone/issues/new">Report a Problem</a>
    </li>
    <li>
      <a href="http://runestoneinteractive.org">About Runestone</a>
    </li>
    <li>
      <a href="/runestone/admin/index">Instructors Page</a>
    </li>
  </ul>
<div class="fb-like" data-href="http://www.facebook.com/RunestoneInteractive" data-send="false" data-layout="button_count" data-width="220" data-show-faces="false"></div>
<p><a href="https://twitter.com/iRunestone" class="twitter-follow-button" data-show-count="false">Follow @iRunestone</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script></p>
</div>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="priority-queues-with-binary-heaps">
<h1>Priority Queues with Binary Heaps<a class="headerlink" href="#priority-queues-with-binary-heaps" title="Permalink to this headline">¶</a></h1>
<p>In Chapter {chap:basicds} you learned about the first in first out data
structure called a queue. One important variation of a queue is called a
<strong>priority queue</strong>. A priority queue acts like a queue in that you
dequeue an item by removing it from the front. However, in a priority
queue the logical order of items inside a queue is determined by their
priority. The highest priority items are at the front of the queue and
the lowest priority items are at the back. Thus when you enqueue an item
on a priority queue, the new item may move all the way to the front. We
will see that the priority queue is a useful data structure for some of
the graph algorithms we will study in the next chapter.</p>
<p>You can probably think of a couple of easy ways to implement a priority
queue using sorting functions and lists. However, inserting into a list
is <span class="math">\(O(n)\)</span> and sorting a list is <span class="math">\(O(n \log{n})\)</span>. We can
do better. The classic way to implement a priority queue is using a data
structure called a <strong>binary heap</strong>. A binary heap will allow us both
enqueue and dequeue items in <span class="math">\(O(\log{n})\)</span>.</p>
<p>The binary heap is interesting to study because when we diagram the heap
it looks a lot like a tree, but when we implement it we use only a
single list as an internal representation. The binary heap has two
common variations: the <strong>min heap</strong>, in which the smallest key is always
at the front, and the <strong>max heap</strong>, in which the largest key value is
always at the front. In this section we will implement the min heap. We
leave a max heap implementation as an exercise.</p>
<div class="section" id="binary-heap-operations">
<h2>Binary Heap Operations<a class="headerlink" href="#binary-heap-operations" title="Permalink to this headline">¶</a></h2>
<p>The basic operations we will implement for our binary heap are as
follows:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">BinaryHeap()</span></tt> creates a new, empty, binary heap.</li>
<li><tt class="docutils literal"><span class="pre">insert(k)</span></tt> adds a new item to the heap.</li>
<li><tt class="docutils literal"><span class="pre">findMin()</span></tt> returns the item with the minimum key value, leaving
item in the heap.</li>
<li><tt class="docutils literal"><span class="pre">delMin()</span></tt> returns the item with the minimum key value, removing
the item from the heap.</li>
<li><tt class="docutils literal"><span class="pre">isEmpty()</span></tt> returns true if the heap is empty, false otherwise.</li>
<li><tt class="docutils literal"><span class="pre">size()</span></tt> returns the number of items in the heap.</li>
<li><tt class="docutils literal"><span class="pre">buildHeap(list)</span></tt> builds a new heap from a list of keys.</li>
</ul>
<p>The following Python session demonstrates the use of some of the binary
heap methods.</p>

<div id="heap1" >

<br/>
<div id="heap1_code_div" style="display: block">
<textarea cols="50" rows="12" id="heap1_code" class="active_code">
from pythonds.trees.binheap import BinHeap
bh = BinHeap()
bh.insert(5)
bh.insert(7)
bh.insert(3)
bh.insert(11)
print(bh.delMin())

print(bh.delMin())

print(bh.delMin())

print(bh.delMin())
</textarea>
</div>
<p class="ac_caption"><span class="ac_caption_text"> (heap1)</span> </p>

<button id="heap1_runb" onclick="runit('heap1',this, undefined);">Run</button>

<div id="cont"></div>

<button class="ac_opt" onclick="saveEditor('heap1');">Save</button>
<button class="ac_opt" onclick="requestCode('heap1');">Load</button>

<div style="text-align: center">
<canvas id="heap1_canvas" height="400" width="400" style="border-style: solid; display: none; text-align: center"></canvas>
</div>

<pre id="heap1_pre" class="active_out">

</pre>


</div>

</div>
<div class="section" id="binary-heap-implementation">
<h2>Binary Heap Implementation<a class="headerlink" href="#binary-heap-implementation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-structure-property">
<h3>The Structure Property<a class="headerlink" href="#the-structure-property" title="Permalink to this headline">¶</a></h3>
<p>In order to make our heap work efficiently, we will take advantage of
the logarithmic nature of the tree to represent our heap. You will learn
in section {sec:stanal} that in order to guarantee logarithmic
performance, we must keep our tree balanced. A balanced binary tree has
roughly the same number of nodes in the left and right subtrees of the
root. In our heap implementation we keep the tree balanced by creating a
<strong>complete binary tree</strong>. A complete binary tree is a tree in which each
level has all of its nodes. The exception to this is the bottom level of
the tree, which we fill in from left to right. <a class="reference internal" href="#fig-comptree"><em>Figure x</em></a>
shows an example of a complete binary tree.</p>
<div class="figure align-center" id="fig-comptree">
<img alt="image" src="../_images/compTree.png" />
<p class="caption">A Complete Binary Tree</p>
</div>
<p>Another interesting property of a complete tree is that we can represent
it using a single list. We do not need to use nodes and references or
even lists of lists. Because the tree is complete, the left child of a
parent (at position <span class="math">\(p\)</span>) is the node that is found in position
<span class="math">\(2p\)</span> in the list. Similarly, the right child of the parent is at
position <span class="math">\(2p + 1\)</span> in the list. To find the parent of any node in
the tree, we can simply use Python’s integer division. Given that a node
is at position <span class="math">\(n\)</span> in the list, the parent is at position
<span class="math">\(n/2\)</span>. <a class="reference internal" href="#fig-heaporder"><em>Figure x</em></a> illustrates a complete binary tree
and also gives the list representation of the tree. The list
representation of the tree, along with the full structure property,
allows us to efficiently traverse a complete binary tree using only a
few simple mathematical operations. We will see that this also leads to
an efficient implementation of our binary heap.</p>
</div>
<div class="section" id="the-heap-order-property">
<h3>The Heap Order Property<a class="headerlink" href="#the-heap-order-property" title="Permalink to this headline">¶</a></h3>
<p>The method that we will use to store items in a heap relies on
maintaining the heap order property. The <strong>heap order property</strong> is as
follows: In a heap, for every node <span class="math">\(x\)</span> with parent <span class="math">\(p\)</span>,
the key in <span class="math">\(p\)</span> is smaller than or equal to the key in
<span class="math">\(x\)</span>. <a class="reference internal" href="#fig-heaporder"><em>Figure x</em></a> also illustrates a complete binary
tree that has the heap order property.</p>
<div class="figure align-center" id="fig-heaporder">
<img alt="image" src="../_images/heapOrder.png" />
<p class="caption">A Complete Binary Tree, along with its List Representation</p>
</div>
</div>
<div class="section" id="heap-operations">
<h3>Heap Operations<a class="headerlink" href="#heap-operations" title="Permalink to this headline">¶</a></h3>
<p>We will begin our implementation of a binary heap with the constructor.
Since the entire binary heap can be represented by a single list, all
the constructor will do is initialize the list and an attribute
<tt class="docutils literal"><span class="pre">currentSize</span></tt> to keep track of the current size of the heap.
Listing&nbsp;{lst:bh:init} shows the Python code for the constructor. You
will notice that an empty binary heap has a single zero as the first
element of <tt class="docutils literal"><span class="pre">heapList</span></tt> and that this zero is not used, but is there so
that simple integer division can be used in later methods.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">currentSize</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>The next method we will implement is <tt class="docutils literal"><span class="pre">insert</span></tt>. The easiest, and most
efficient, way to add an item to a list is to simply append the item to
the end of the list. The good news about appending is that it guarantees
that we will maintain the complete tree property. The bad news about
appending is that we will very likely violate the heap structure
property. However, it is possible to write a method that will allow us
to regain the heap structure property by comparing the newly added item
with its parent. If the newly added item is less than its parent, then
we can swap the item with its parent. <a class="reference internal" href="#fig-percup"><em>Figure x</em></a> shows the
series of swaps needed to percolate the newly added item up to its
proper position in the tree.</p>
<div class="figure align-center" id="fig-percup">
<img alt="image" src="../_images/percUp.png" />
<p class="caption">Percolate the New Node up to Its Proper Position</p>
</div>
<p>Notice that when we percolate an item up, we are restoring the heap
property between the newly added item and the parent. We are also
preserving the heap property for any siblings. Of course, if the newly
added item is very small, we may still need to swap it up another level.
In fact, we may need to keep swapping until we get to the top of the
tree. Listing&nbsp;{lst:bh:helpers} shows the <tt class="docutils literal"><span class="pre">percUp</span></tt> method, which
percolates a new item as far up in the tree as it needs to go to
maintain the heap property. Here is where our wasted element in
<tt class="docutils literal"><span class="pre">heapList</span></tt> is important. Notice that we can compute the parent of any
node by using simple integer division. The parent of the current node
can be computed by dividing the index of the current node by 2.</p>
<p>We are now ready to write the <tt class="docutils literal"><span class="pre">insert</span></tt> method. The Python code for
<tt class="docutils literal"><span class="pre">insert</span></tt> is shown in Listing&nbsp;{lst:bh:add}. Most of the work in the
<tt class="docutils literal"><span class="pre">insert</span></tt> method is really done by <tt class="docutils literal"><span class="pre">percUp</span></tt>. Once a new item is
appended to the tree, <tt class="docutils literal"><span class="pre">percUp</span></tt> takes over and positions the new item
properly.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">percUp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">):</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]:</span>
         <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span><span class="p">[</span><span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
         <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span>
      <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">currentSize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentSize</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">percUp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currentSize</span><span class="p">)</span>
</pre></div>
</div>
<p>With the <tt class="docutils literal"><span class="pre">insert</span></tt> method properly defined, we can now look at the
<tt class="docutils literal"><span class="pre">delMin</span></tt> method. Since the heap property requires that the root of the
tree be the smallest item in the tree, finding the minimum item is easy.
The hard part of <tt class="docutils literal"><span class="pre">delMin</span></tt> is restoring full compliance with the heap
structure and heap order properties after the root has been removed. We
can restore our heap in two steps. First, we will restore the root item
by taking the last item in the list and moving it to the root position.
Moving the last item maintains our heap structure property. However, we
have probably destroyed the heap order property of our binary heap.
Second, we will restore the heap order property by pushing the new root
node down the tree to its proper position. <a class="reference internal" href="#fig-percdown"><em>Figure x</em></a> shows
the series of swaps needed to move the new root node to its proper
position in the heap.</p>
<div class="figure align-center" id="fig-percdown">
<img alt="image" src="../_images/percDown.png" />
<p class="caption">Percolating the Root Node down the Tree</p>
</div>
<p>In order to maintain the heap order property, all we need to do is swap
the root with its smallest child less than the root. After the initial
swap, we may repeat the swapping process with a node and its children
until the node is swapped into a position on the tree where it is
already less than both children. The code for percolating a node down
the tree is found in the <tt class="docutils literal"><span class="pre">percDown</span></tt> and <tt class="docutils literal"><span class="pre">minChild</span></tt> methods in
Listing&nbsp;{lst:bh:pdown}.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">percDown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">):</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentSize</span><span class="p">:</span>
        <span class="n">mc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minChild</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span><span class="p">[</span><span class="n">mc</span><span class="p">]:</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span><span class="p">[</span><span class="n">mc</span><span class="p">]</span> <span class="o">=</span> <span class="n">tmp</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">mc</span>

<span class="k">def</span> <span class="nf">minChild</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">i</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentSize</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">]:</span>
            <span class="k">return</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
<p>The code for the <tt class="docutils literal"><span class="pre">delmin</span></tt> operation is in Listing&nbsp;{lst:bh:del}. Note
that once again the hard work is handled by a helper function, in this
case <tt class="docutils literal"><span class="pre">percDown</span></tt>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">delMin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">retval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">currentSize</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">currentSize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentSize</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">percDown</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">retval</span>
</pre></div>
</div>
<p>To finish our discussion of binary heaps, we will look at a method to
build an entire heap from a list of keys. The first method you might
think of may be like the following. Given a list of keys, you could
easily build a heap by inserting each key one at a time. Since you are
starting with a list of one item, the list is sorted and you could use
binary search to find the right position to insert the next key at a
cost of approximately <span class="math">\(O(\log{n})\)</span> operations. However, remember
that inserting an item in the middle of the list may require
<span class="math">\(O(n)\)</span> operations to shift the rest of the list over to make
room for the new key. Therefore, to insert <span class="math">\(n\)</span> keys into the
heap would require a total of <span class="math">\(O(n \log{n})\)</span> operations.
However, if we start with an entire list then we can build the whole
heap in <span class="math">\(O(n)\)</span> operations. Listing&nbsp;{lst:bh:build} shows the code
to build the entire heap.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">buildHeap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">alist</span><span class="p">):</span>
    <span class="n">i</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">alist</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">currentSize</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">alist</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">heapList</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">alist</span><span class="p">[:]</span>
    <span class="k">while</span> <span class="p">(</span><span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>  <span class="c">#// \label{lst:bh:loop}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">percDown</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="figure align-center" id="fig-buildheap">
<img alt="image" src="../_images/buildheap.png" />
<p class="caption">Building a Heap from the List [9, 6, 5, 2, 3]</p>
</div>
<p><a class="reference internal" href="#fig-buildheap"><em>Figure x</em></a> shows the swaps that the <tt class="docutils literal"><span class="pre">buildHeap</span></tt> method
makes as it moves the nodes in an initial tree of {[9, 6, 5, 2, 3]} into
their proper positions. Although we start out in the middle of the tree
and work our way back toward the root, the <tt class="docutils literal"><span class="pre">percDown</span></tt> method ensures
that the largest child is always moved down the tree. Because it is a
complete binary tree, any nodes past the halfway point will be leaves
and therefore have no children. Notice that when <tt class="docutils literal"><span class="pre">i=1</span></tt>, we are
percolating down from the root of the tree, so this may require multiple
swaps. As you can see in the rightmost two subtrees of
<a class="reference internal" href="#fig-buildheap"><em>Figure x</em></a>, first the 9 is moved out of the root position,
but after 9 is moved down one level in the tree, <tt class="docutils literal"><span class="pre">percDown</span></tt> ensures
that we check the next set of children farther down in the tree to
ensure that it is pushed as low as it can go. In this case it results in
a second swap with 3. Now that 9 has been moved to the lowest level of
the tree, no further swapping can be done. It is useful to compare the
list representation of this series of swaps as shown in
<a class="reference internal" href="#fig-buildheap"><em>Figure x</em></a> with the tree representation.</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
<p>{Building a Heap from the List [9, 5, 6, 2, 3]} {fig:bldheap}</p>
</div></blockquote>
<p>The assertion that we can build the heap in <span class="math">\(O(n)\)</span> may seem a
bit mysterious at first, and a proof is beyond the scope of this book.
However, the key to understanding that you can build the heap in
<span class="math">\(O(n)\)</span> is to remember that the <span class="math">\(\log{n}\)</span> factor is
derived from the height of the tree. For most of the work in
<tt class="docutils literal"><span class="pre">buildHeap</span></tt>, the tree is shorter than <span class="math">\(\log{n}\)</span>.</p>
<p>Using the fact that you can build a heap from a list in <span class="math">\(O(n)\)</span>
time, you will construct a sorting algorithm that uses a heap and sorts
a list in <span class="math">\(O(n\log{n}))\)</span> as an exercise at the end of this
chapter.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="bst.html" title="Binary Search Trees"
             >next</a> |</li>
        <li class="right" >
          <a href="bintreeapps.html" title="Binary Tree Applications"
             >previous</a> |</li>
        <li><a href="../index.html">Python Courseware</a> &raquo;</li>
<li class="right"><span class="loginout"><a href="/runestone/default/user/logout">logout</a></span>| </li>

      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2012, Brad Miller, David Ranum.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>

<script type="text/javascript" charset="utf-8">
    $(document).ready(addUserToFooter)
    $(document).ready(createEditors);
    $(document).ready(getNumUsers);
    $(document).ready(getOnlineUsers);
</script>




  </body>
</html>